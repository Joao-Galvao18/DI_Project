<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoSim - Modern UI</title>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <button id="menu-toggle" class="menu-btn"><i class="ph ph-list"></i></button>

    <aside id="sidebar" class="sidebar">
        
        <div class="sidebar-header">
            <h2>ECO-CONTROL</h2>
            <button id="close-menu" class="close-btn"><i class="ph ph-x"></i></button>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="ui.switchTab('environment')">
                <i class="ph ph-globe-hemisphere-west" style="margin-right:5px; vertical-align:middle"></i> Environment
            </button>
            <button class="tab-btn" onclick="ui.switchTab('species')">
                <i class="ph ph-dna" style="margin-right:5px; vertical-align:middle"></i> Species
            </button>
        </div>

        <div class="content-wrapper">
            
            <div id="sidebar-lock" class="sidebar-lock hidden">
                <div class="lock-msg">
                    <i class="ph ph-lock-key" style="font-size: 40px; margin-bottom: 10px;"></i><br>
                    <strong>REPLAYING</strong><br>
                    <small>Go Live to Edit</small>
                </div>
                
                <button id="btn-go-live" class="live-btn hidden" onclick="sim.goLive()">
                    <i class="ph ph-broadcast"></i> GO LIVE
                </button>

                <button id="btn-restart" class="restart-btn hidden" onclick="ui.openRestartModal()">
                    <i class="ph ph-arrows-clockwise"></i> RESTART FROM HERE
                </button>
            </div>

            <div class="sidebar-body">
                <div id="tab-environment" class="tab-content active-content">
                    <div class="control-group">
                        <label><i class="ph ph-thermometer"></i> Temperature <span id="val-temp">25Â°C</span></label>
                        <input type="range" id="slider-temp" min="15" max="35" value="25">
                    </div>
                    <div class="control-group">
                        <label><i class="ph ph-drop"></i> Pollution <span id="val-pol">0%</span></label>
                        <input type="range" id="slider-pol" min="0" max="100" value="0">
                    </div>
                    <hr class="divider">
                    <label style="font-size:12px; color:#94a3b8; font-weight:600; margin-bottom:10px; display:block;">VISUALIZATION</label>
                    <div class="view-toggles">
                        <button class="btn-sm active" id="view-std" onclick="sim.toggleView('standard')">Standard</button>
                        <button class="btn-sm" id="view-heat" onclick="sim.toggleView('heatmap')">Heatmap</button>
                    </div>
                </div>

                <div id="tab-species" class="tab-content">
                    <p class="hint">Click or Drag to spawn</p>
                    
                    <div class="draggable-item" draggable="true" ondragstart="ui.drag(event, 'fish')" onclick="ui.clickSpawn('fish')">
                        <i class="ph ph-fish-simple icon"></i> <span>Small Fish</span>
                    </div>
                    
                    <div class="draggable-item" draggable="true" ondragstart="ui.drag(event, 'shark')" onclick="ui.clickSpawn('shark')">
                        <i class="ph ph-sword icon"></i> <span>Predator</span>
                    </div>
                    
                    <div class="draggable-item" draggable="true" ondragstart="ui.drag(event, 'coral')" onclick="ui.clickSpawn('coral')">
                        <i class="ph ph-circle-dashed icon"></i> <span>Coral</span>
                    </div>

                    <div class="draggable-item" draggable="true" ondragstart="ui.drag(event, 'shrimp')" onclick="ui.clickSpawn('shrimp')">
                        <i class="ph ph-shrimp icon"></i> <span>Shrimp</span>
                    </div>
                    
                    <div class="draggable-item" draggable="true" ondragstart="ui.drag(event, 'algae')" onclick="ui.clickSpawn('algae')">
                        <i class="ph ph-plant icon"></i> <span>Algae</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar-footer">
            <button class="btn-reset" onclick="location.reload()"><i class="ph ph-arrow-counter-clockwise"></i> RESET SIMULATION</button>
        </div>
    </aside>

    <main class="viewport">
        <div id="toast-container"></div>

        <div id="tooltip" class="tooltip hidden">
            <strong id="tt-type">Type</strong>
            <div id="tt-health">Health: 100%</div>
        </div>

        <div class="top-bar">
            <button id="ui-btn" class="icon-btn" onclick="ui.toggleUI()" title="Toggle UI"><i class="ph ph-eye"></i></button>
        </div>

        <canvas id="simCanvas"></canvas>

        <div id="timeline-container" class="timeline-container">
            <button id="btn-play" class="play-btn" onclick="sim.togglePlay()"><i class="ph ph-pause"></i></button>
            
            <div id="timeline-scroll-area" class="timeline-scroll-area">
                <div class="timeline-content-wrapper">
                    <div id="timeline-track" class="timeline-track">
                        <div id="timeline-buffer" class="timeline-buffer"></div>
                        <div id="timeline-fill" class="timeline-fill"></div>
                        <div id="timeline-markers"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="modal-restart" class="modal-overlay hidden">
        <div class="modal-box">
            <div class="modal-icon"><i class="ph ph-clock-clockwise"></i></div>
            <h3>Resume Simulation?</h3>
            <p>You are about to jump back in and take control from this point.</p>
            <p class="warning-text" style="font-weight:normal; opacity:0.8">Any events that happened <em>after</em> this moment will be overwritten.</p>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="ui.closeRestartModal()">Cancel</button>
                <button class="btn-confirm" onclick="ui.confirmRestart()">Yes, Resume Here</button>
            </div>
        </div>
    </div>

    <script src="ui.js"></script>
    <script src="agent.js"></script>
    <script src="engine.js"></script>
    <script src="main.js"></script>
</body>
</html>